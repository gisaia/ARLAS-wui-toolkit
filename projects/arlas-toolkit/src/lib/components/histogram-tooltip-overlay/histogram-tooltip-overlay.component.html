<arlas-widget-tooltip [title]="tooltip.title">
  <ng-container xLabel>
    {{ tooltip.xLabel | translate }}
    <span class="axis-label">({{ 'x-axis' | translate }})</span>
  </ng-container>

  <ng-container xValue>
    <ng-container *ngTemplateOutlet="intervalTemplate; context: {value: interval.start}"></ng-container>
    <!-- keep this because we ll need this later -->
    <span class="interval-text" *ngIf="displayText">{{ 'to' | translate }}</span>
    <ng-container *ngTemplateOutlet="intervalTemplate; context: {value: interval.end}"></ng-container>
    <ng-container *ngTemplateOutlet="intervalTextTemplate;
      context: {
        unit: tooltip.xUnit,
        interval: tooltip.xRange.unit,
        intervalValue: tooltip.xRange.value,
        isTime: tooltip.dataType === 'time'
        }"></ng-container>
  </ng-container>

  <ng-container yLabel>
    {{ tooltip.yLabel | translate }}
    <span class="axis-label">({{ 'y-axis' | translate }})</span>
  </ng-container>

  <ng-container yValue>
    <table class="values">
      @for (y of tooltip.y; track y) {
        <tr>
          <td>
            <div class="chip" [style.backgroundColor]="y.color"></div>
          </td>
          <td class="count">
            <div>{{ y.value }}</div>
          </td>

          @if (tooltip?.dataType === 'time') {
            <td>
              <div class="value-unit">
                {{ ((tooltip.yUnit && tooltip.yUnit.length > 0) ? tooltip.yUnit : y.chartId | getCollectionUnit) | translate }}
              </div>
            </td>
          } @else if (tooltip.yUnit !== undefined && tooltip.yUnit !== '') {
            <td>
              <div class="value-unit">{{ tooltip.yUnit | translate }}</div>
            </td>
          }
        </tr>
      }
    </table>
  </ng-container>
</arlas-widget-tooltip>

<!-- template for x and y values -->
<ng-template #intervalTemplate let-value="value" let-isTime="isTime">
  @if (value !== undefined && value !== null) {
    <span class="interval-value">
      {{ value }}
    </span>
  }
</ng-template>

<!-- display the text after the interval -->
<ng-template #intervalTextTemplate let-interval="interval" let-intervalValue="intervalValue"
             let-unit="unit" let-isTypeTime="isTime">
  @if (isTypeTime) {
    <span class="interval-text">{{ intervalValue }}</span>
  } @else if (unit) {
    <span class="interval-text">{{ unit | translate }}</span>
  }

  @if (isTypeTime && interval) {
    <span class="interval-text">{{ interval | translate }}</span>
  }
  @if (!isTypeTime && intervalValue) {
    <span class="interval-text">({{ 'interval' | translate }} : {{ intervalValue }})</span>
  }
</ng-template>
