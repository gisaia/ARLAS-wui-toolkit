<arlas-timeline-shortcut class="arlas-timeline--timeshortcuts" [activeDatePicker]="activeDatePicker"
    [timelineComponent]="timelineComponent" [dateFormat]="timelineComponent?.dateFormat"
    [isDisplayHistogram]="isDisplayHistogram" (isDisplayHistogramChange)="toggleTimeline()"></arlas-timeline-shortcut>

<div class="arlas-timeline--container" *ngIf="isDisplayHistogram" #arlasTimeline>
  <div class="arlas-timeline--legend" *ngIf="!!timelineLegend && timelineLegend.length > 1">
    <div *ngFor="let collectionLegend of timelineLegend" class="arlas-timeline--legend-container"
      (click)="hideShowCollection(collectionLegend)">
      <div class="arlas-timeline--legend-chip"
        [style.backgroundColor]="collectionLegend.active ? collectionLegend.color : '#dadada'"></div>
      <div class="arlas-timeline--legend-collection" [style.color]="collectionLegend.active ? '#444' : '#bbb'">
        {{ collectionLegend.display_name | translate }}</div>
    </div>
  </div>
  <div *ngIf="detailedTimelineComponent" class="show-detailedtimeline-{{showDetailedTimeline.valueOf()}}"
    (mouseleave)="hideHistogramTooltip()">
    <arlas-histogram #detailedtimeline [data]="detailedTimelineData" [mainChartId]="mainCollection"
      [intervalSelection]="detailedTimelineIntervalSelection" (dataPlottedEvent)="afterDetailedDataPlotted($event)"
      (valuesListChangedEvent)="onDetailedIntervalBrushed($event)" [id]="detailedTimelineComponent?.input?.id"
      [displayOnlyIntervalsWithData]=true [dataType]="detailedTimelineComponent?.input?.dataType"
      [dataUnit]="detailedTimelineComponent?.input?.dataUnit"
      [valuesDateFormat]="detailedTimelineComponent?.input?.valuesDateFormat"
      [isHistogramSelectable]="detailedTimelineComponent?.input?.isHistogramSelectable === undefined ? true : detailedTimelineComponent?.input?.isHistogramSelectable "
      [multiselectable]="detailedTimelineComponent?.input?.multiselectable"
      [topOffsetRemoveInterval]="detailedTimelineComponent?.input?.topOffsetRemoveInterval"
      [leftOffsetRemoveInterval]="detailedTimelineComponent?.input?.leftOffsetRemoveInterval"
      [brushHandlesHeightWeight]="!!detailedTimelineComponent?.input?.brushHandlesHeightWeight ? detailedTimelineComponent?.input?.brushHandlesHeightWeight : 0.8 "
      [chartType]="detailedTimelineComponent?.input?.chartType"
      [chartTitle]="detailedTimelineComponent?.input?.chartTitle"
      [chartWidth]="!!detailedTimelineComponent?.input?.chartWidth ? detailedTimelineComponent?.input?.chartWidth : null "
      [chartHeight]="!!detailedTimelineComponent?.input?.chartHeight ? detailedTimelineComponent?.input?.chartHeight : 128"
      [customizedCssClass]="detailedTimelineComponent?.input?.customizedCssClass"
      [xAxisPosition]="detailedTimelineComponent?.input?.xAxisPosition"
      [descriptionPosition]="detailedTimelineComponent?.input?.descriptionPosition"
      [xTicks]="detailedTimelineComponent?.input?.xTicks" [yTicks]="detailedTimelineComponent?.input?.yTicks"
      [xLabels]="detailedTimelineComponent?.input?.xLabels" [yLabels]="detailedTimelineComponent?.input?.yLabels"
      [showXTicks]="detailedTimelineComponent?.input?.showXTicks"
      [showYTicks]="detailedTimelineComponent?.input?.showYTicks"
      [showXLabels]="detailedTimelineComponent?.input?.showXLabels"
      [showYLabels]="detailedTimelineComponent?.input?.showYLabels"
      [ticksDateFormat]="detailedTimelineComponent?.input?.ticksDateFormat"
      [isSmoothedCurve]="detailedTimelineComponent?.input?.isSmoothedCurve"
      [barWeight]="detailedTimelineComponent?.input?.barWeight"
      [paletteColors]="detailedTimelineComponent?.input?.paletteColors"
      [applyOffsetOnAreaChart]="detailedTimelineComponent?.input?.applyOffsetOnAreaChart"
      [displayOnlyIntervalsWithData]="detailedTimelineComponent?.input?.displayOnlyIntervalsWithData"
      [yAxisStartsFromZero]="detailedTimelineComponent?.input?.yAxisStartsFromZero"
      [showStripes]="detailedTimelineComponent?.input?.showStripes"
      [chartXLabel]="detailedTimelineComponent?.input?.chartXLabel"
      [shortYLabels]="detailedTimelineComponent?.input?.shortYLabels" [xUnit]="detailedTimelineComponent?.input?.xUnit"
      [yUnit]="detailedTimelineComponent?.input?.yUnit" [useUtc]="detailedTimelineContributor?.useUtc"
      (tooltipEvent)="emitTooltip($event,arlasTimeline)"></arlas-histogram>
  </div>
  <div *ngIf="timelineComponent" (mouseleave)="hideHistogramTooltip()">
    <arlas-histogram #timeline [intervalListSelection]="timelineContributor?.intervalListSelection"
      [intervalSelection]="timelineContributor?.intervalSelection" [data]="timelineData"
      (valuesListChangedEvent)="onTimelineIntervalBrushed($event)" [mainChartId]="mainCollection"
      [id]="timelineComponent?.input?.id" [dataType]="timelineComponent?.input?.dataType"
      [dataUnit]="timelineComponent?.input?.dataUnit" [valuesDateFormat]="timelineComponent?.input?.valuesDateFormat"
      [isHistogramSelectable]="timelineComponent?.input?.isHistogramSelectable === undefined ? true : timelineComponent?.input?.isHistogramSelectable "
      [multiselectable]="timelineComponent?.input?.multiselectable"
      [topOffsetRemoveInterval]="timelineComponent?.input?.topOffsetRemoveInterval"
      [leftOffsetRemoveInterval]="timelineComponent?.input?.leftOffsetRemoveInterval"
      [brushHandlesHeightWeight]="!!timelineComponent?.input?.brushHandlesHeightWeight ? timelineComponent?.input?.brushHandlesHeightWeight : 0.8 "
      [chartType]="timelineComponent?.input?.chartType" [chartTitle]="timelineComponent?.input?.chartTitle"
      [chartWidth]="!!timelineComponent?.input?.chartWidth ? timelineComponent?.input?.chartWidth : null "
      [chartHeight]="!!timelineComponent?.input?.chartHeight ? timelineComponent?.input?.chartHeight : 128"
      [customizedCssClass]="timelineComponent?.input?.customizedCssClass"
      [xAxisPosition]="timelineComponent?.input?.xAxisPosition"
      [descriptionPosition]="timelineComponent?.input?.descriptionPosition" [xTicks]="timelineComponent?.input?.xTicks"
      [yTicks]="timelineComponent?.input?.yTicks" [xLabels]="timelineComponent?.input?.xLabels"
      [yLabels]="timelineComponent?.input?.yLabels" [showXTicks]="timelineComponent?.input?.showXTicks"
      [showYTicks]="timelineComponent?.input?.showYTicks" [showXLabels]="timelineComponent?.input?.showXLabels"
      [showYLabels]="timelineComponent?.input?.showYLabels"
      [ticksDateFormat]="timelineComponent?.input?.ticksDateFormat"
      [isSmoothedCurve]="timelineComponent?.input?.isSmoothedCurve" [barWeight]="timelineComponent?.input?.barWeight"
      [paletteColors]="timelineComponent?.input?.paletteColors"
      [applyOffsetOnAreaChart]="timelineComponent?.input?.applyOffsetOnAreaChart"
      [displayOnlyIntervalsWithData]="timelineComponent?.input?.displayOnlyIntervalsWithData"
      [yAxisStartsFromZero]="timelineComponent?.input?.yAxisStartsFromZero"
      [showStripes]="timelineComponent?.input?.showStripes" [chartXLabel]="timelineComponent?.input?.chartXLabel"
      [shortYLabels]="timelineComponent?.input?.shortYLabels" [xUnit]="timelineComponent?.input?.xUnit"
      [yUnit]="timelineComponent?.input?.yUnit" [useUtc]="timelineContributor?.useUtc"
      (tooltipEvent)="emitTooltip($event,arlasTimeline)"></arlas-histogram>
  </div>
  <div *ngIf="timelineData.length === 0" class="timeline-empty">
    <mat-icon class="icon">event_busy</mat-icon>
    {{ 'No data available.' | translate }}
  </div>
</div>
